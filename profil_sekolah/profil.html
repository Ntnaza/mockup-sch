<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil Instansi - Aplikasi Sekolah</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <style>
        .form-input {
            width: 100%; border-radius: 0.5rem; border: 1px solid #D1D5DB; padding: 0.5rem 0.75rem; font-size: 0.875rem; transition: all 0.2s ease;
        }
        .form-input:focus, .form-input-disabled:focus {
            border-color: #3B82F6; box-shadow: 0 0 0 2px #BFDBFE; outline: none;
        }
        .form-input-disabled {
            background-color: #F3F4F6; color: #6B7280; cursor: not-allowed;
        }
        .form-label {
            display: block; margin-bottom: 0.25rem; font-size: 0.875rem; font-weight: 500; color: #374151;
        }
        .tab-link {
            padding: 0.75rem 1.5rem; font-weight: 500; color: #4B5563; border-bottom: 2px solid transparent; transition: all 0.2s ease; display: flex; align-items: center;
        }
        .tab-link.active {
            color: #3B82F6; border-bottom-color: #3B82F6;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .image-preview {
            width: 128px; height: 128px; border: 2px dashed #D1D5DB; border-radius: 0.5rem;
            display: flex; align-items: center; justify-content: center; background-color: #F9FAFB;
            background-size: cover; background-position: center;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="flex h-screen">
        <!-- Placeholder untuk Sidebar -->
        <div id="sidebar-placeholder"></div>

        <main class="flex-1 p-6 md:p-8 overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">Profil Instansi</h1>
                    <p id="current-time" class="text-gray-500"></p>
                </div>
                <button id="save-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg flex items-center gap-2 transition-all duration-200 shadow-sm">
                    <ion-icon name="save-outline"></ion-icon>
                    <span>Simpan</span>
                </button>
            </div>

            <div class="bg-white rounded-lg shadow-md">
                <div class="border-b border-gray-200">
                    <nav id="tabs-container" class="flex flex-wrap">
                        <a href="#profil" class="tab-link active" data-tab="profil"><ion-icon name="person-circle-outline" class="mr-2"></ion-icon>Profil</a>
                        <a href="#gambar" class="tab-link" data-tab="gambar"><ion-icon name="image-outline" class="mr-2"></ion-icon>Gambar</a>
                        <a href="#alamat" class="tab-link" data-tab="alamat"><ion-icon name="location-outline" class="mr-2"></ion-icon>Alamat</a>
                        <a href="#peta" class="tab-link" data-tab="peta"><ion-icon name="map-outline" class="mr-2"></ion-icon>Peta</a>
                    </nav>
                </div>

                <div class="p-6">
                    <!-- Tab Content: Profil -->
                    <div id="tab-profil" class="tab-content active">
                         <form id="profil-form" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                            <div><label class="form-label">Nama Instansi</label><input type="text" id="nama_instansi" class="form-input"></div>
                            <div><label class="form-label">Bidang Studi</label><input type="text" id="bidang_studi" class="form-input"></div>
                            <div><label class="form-label">Singkatan / Inisial</label><input type="text" id="singkatan" class="form-input"></div>
                            <div><label class="form-label">Tahun Berdiri</label><input type="text" id="tahun_berdiri" class="form-input"></div>
                            <div><label class="form-label">Status</label><input type="text" id="status" class="form-input"></div>
                            <div><label class="form-label">NSS</label><input type="text" id="nss" class="form-input"></div>
                            <div><label class="form-label">Kode</label><input type="text" id="kode" class="form-input"></div>
                            <div><label class="form-label">NPSN</label><input type="text" id="npsn" class="form-input"></div>
                            <div><label class="form-label">Nama Kepala Aktif</label><input type="text" id="nama_kepala" class="form-input form-input-disabled" readonly></div>
                             <div><label class="form-label">Luas</label><input type="text" id="luas" class="form-input"></div>
                            <div><label class="form-label">NIP/NIY Kepala Aktif</label><input type="text" id="nip_kepala" class="form-input form-input-disabled" readonly></div>
                            <div><label class="form-label">Moto</label><textarea id="moto" class="form-input h-24"></textarea></div>
                        </form>
                    </div>

                    <!-- Tab Content: Gambar -->
                    <div id="tab-gambar" class="tab-content">
                        <form id="gambar-form" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="text-center">
                                <h3 class="font-semibold mb-2 text-gray-700">LOGO</h3>
                                <div id="logo-preview" class="image-preview mx-auto">
                                    <span class="text-gray-400 text-sm">Pratinjau</span>
                                </div>
                                <input type="file" id="logo-input" class="hidden" accept="image/png, image/jpeg, image/gif, image/ico">
                                <button type="button" onclick="document.getElementById('logo-input').click()" class="mt-4 text-sm bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg">Choose File</button>
                                <p class="text-xs text-gray-500 mt-2">Tipe: jpeg, png, jpg, gif, ico<br>Size: 2MB</p>
                            </div>
                             <div class="text-center">
                                <h3 class="font-semibold mb-2 text-gray-700">ICON</h3>
                                <div id="icon-preview" class="image-preview mx-auto">
                                     <span class="text-gray-400 text-sm">Pratinjau</span>
                                </div>
                                <input type="file" id="icon-input" class="hidden" accept="image/png, image/jpeg, image/gif, image/ico">
                                <button type="button" onclick="document.getElementById('icon-input').click()" class="mt-4 text-sm bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg">Choose File</button>
                                <p class="text-xs text-gray-500 mt-2">Tipe: jpeg, png, jpg, gif, ico<br>Size: 2MB</p>
                            </div>
                        </form>
                    </div>

                    <!-- Tab Content: Alamat -->
                    <div id="tab-alamat" class="tab-content">
                        <form id="alamat-form" class="grid grid-cols-1 md:grid-cols-3 gap-x-8 gap-y-4">
                            <!-- Kolom 1 -->
                            <div class="space-y-4">
                                <div><label class="form-label">Alamat (lengkap dengan nomor, rt dan rw)</label><input type="text" id="alamat_lengkap" class="form-input"></div>
                                <div><label class="form-label">Desa/Kelurahan</label><input type="text" id="desa" class="form-input"></div>
                                <div><label class="form-label">Kecamatan</label><input type="text" id="kecamatan" class="form-input"></div>
                                <div><label class="form-label">Kabupaten</label><input type="text" id="kabupaten" class="form-input"></div>
                                <div><label class="form-label">Provinsi</label><input type="text" id="provinsi" class="form-input"></div>
                                <div><label class="form-label">Kode Pos</label><input type="text" id="kode_pos" class="form-input"></div>
                            </div>
                             <!-- Kolom 2 -->
                            <div class="space-y-4">
                                <div><label class="form-label">Telepon</label><input type="text" id="telepon" class="form-input"></div>
                                <div><label class="form-label">Faximile</label><input type="text" id="faximile" class="form-input"></div>
                                <div><label class="form-label">E-mail</label><input type="email" id="email" class="form-input"></div>
                                <div><label class="form-label">Situs/Website</label><input type="url" id="website" class="form-input"></div>
                                <div><label class="form-label">Facebook</label><input type="text" id="facebook" class="form-input"></div>
                                <div><label class="form-label">Twitter</label><input type="text" id="twitter" class="form-input"></div>
                            </div>
                             <!-- Kolom 3 -->
                            <div class="space-y-4">
                                <div><label class="form-label">Skype</label><input type="text" id="skype" class="form-input"></div>
                                <div><label class="form-label">Pinterest</label><input type="text" id="pinterest" class="form-input"></div>
                                <div><label class="form-label">RSS</label><input type="text" id="rss" class="form-input"></div>
                                <div><label class="form-label">Google Plus</label><input type="text" id="google_plus" class="form-input"></div>
                                <div><label class="form-label">Dribble</label><input type="text" id="dribble" class="form-input"></div>
                                <div><label class="form-label">Youtube</label><input type="text" id="youtube" class="form-input"></div>
                            </div>
                        </form>
                    </div>

                    <!-- Tab Content: Peta -->
                    <div id="tab-peta" class="tab-content">
                        <form id="peta-form">
                            <div class="mb-4"><label class="form-label">Embed Peta Google Maps</label><textarea id="embed_peta" class="form-input h-32" placeholder="Tempelkan kode embed dari Google Maps di sini..."></textarea></div>
                            <div class="bg-gray-100 rounded-lg p-4 text-center">
                                <p class="text-gray-600">Pratinjau Peta Akan Tampil di Sini</p>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Memuat file JavaScript terpisah -->
    <script src="../assets/app.js" defer></script>
    <script src="../assets/sidebar-sub.js" defer></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabsContainer = document.getElementById('tabs-container');
            const saveButton = document.getElementById('save-button');
            const PROFIL_KEY = 'profilInstansiData';
            const ALAMAT_KEY = 'alamatInstansiData';
            
            // --- TIME DISPLAY ---
            const timeElement = document.getElementById('current-time');
            const updateTime = () => {
                const now = new Date();
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
                timeElement.textContent = now.toLocaleDateString('id-ID', options);
            };
            setInterval(updateTime, 1000);
            updateTime();

            // --- TAB LOGIC ---
            tabsContainer.addEventListener('click', (e) => {
                e.preventDefault();
                const link = e.target.closest('.tab-link');
                if (link) {
                    tabsContainer.querySelector('.active').classList.remove('active');
                    link.classList.add('active');
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    document.getElementById(`tab-${link.dataset.tab}`).classList.add('active');
                }
            });

            // --- SAVE & LOAD LOGIC ---
            const loadData = () => {
                // Load Profil
                const profilData = JSON.parse(localStorage.getItem(PROFIL_KEY)) || {
                    nama_instansi: 'SMK NURUL ISLAM CIANJUR', bidang_studi: 'Bisnis Manajemen dan Teknik Komputer dan Informatika', singkatan: 'SMKNIS', tahun_berdiri: '1999', status: 'Swasta', nss: '344020723007', kode: '137', npsn: '20203728', nama_kepala: 'Diisi dari menu Kepegawaian', nip_kepala: 'Diisi dari menu Kepegawaian', luas: '25000', moto: '-'
                };
                for (const [key, value] of Object.entries(profilData)) {
                    const el = document.getElementById(key);
                    if (el) el.value = value;
                }
                
                // Load Alamat
                const alamatData = JSON.parse(localStorage.getItem(ALAMAT_KEY)) || {
                    alamat_lengkap: 'Jl. Raya Ciajur Bandung Km. 09 Rt/Rw 001/007 Desa Selajambe', telepon: '(0263) 325749', faximile: '(0263) 325912', email: 'info@smknis.sch.id', website: 'https://smknis.sch.id', kode_pos: '43264', kabupaten: 'Cianjur', provinsi: 'Jawa Barat', desa: 'Selajambe', kecamatan: 'Sukaluyu', facebook: '-', twitter: '-', skype: '-', pinterest: '-', rss: '-', google_plus: '-', dribble: '-', youtube: '-'
                };
                 for (const [key, value] of Object.entries(alamatData)) {
                    const el = document.getElementById(key);
                    if (el) el.value = value;
                }
            };
            
            const saveData = () => {
                // Save Profil
                const profilData = {};
                document.querySelectorAll('#profil-form input, #profil-form textarea').forEach(el => { profilData[el.id] = el.value; });
                localStorage.setItem(PROFIL_KEY, JSON.stringify(profilData));
                
                // Save Alamat
                const alamatData = {};
                document.querySelectorAll('#alamat-form input, #alamat-form textarea').forEach(el => { alamatData[el.id] = el.value; });
                localStorage.setItem(ALAMAT_KEY, JSON.stringify(alamatData));
                
                App.helpers.showToast('Data berhasil disimpan!');
            };

            saveButton.addEventListener('click', saveData);

            // --- IMAGE PREVIEW LOGIC ---
            function setupImagePreview(inputId, previewId) {
                const input = document.getElementById(inputId);
                const preview = document.getElementById(previewId);
                input.addEventListener('change', function() {
                    const file = this.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            preview.style.backgroundImage = `url('${e.target.result}')`;
                            preview.innerHTML = '';
                        }
                        reader.readAsDataURL(file);
                    }
                });
            }
            setupImagePreview('logo-input', 'logo-preview');
            setupImagePreview('icon-input', 'icon-preview');

            loadData();
        });
    </script>
</body>
</html>
